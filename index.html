<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helix - Protein Visualization</title>
    <link rel="stylesheet" href="/src/styles.css">
</head>
<body>
    <div id="canvas-container">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="hamburger" id="hamburgerBtn">☰</div>
            <div class="logo">Helix</div>
            <div class="divider"></div>
            <div class="quick-action primary" id="loadProteinBtn">Load Protein</div>
            <div class="spacer"></div>
            <div class="quick-action" id="exportBtn">Export Image</div>
            <div class="quick-action" id="helpBtn">Help</div>
        </div>

        <!-- Toolbar -->
        <div class="toolbar">
            <div class="toolbar-group">
                <span class="toolbar-label">Style:</span>
                <select id="representation">
                    <option value="spheres">Ball & Stick</option>
                    <option value="wireframe">Wireframe</option>
                    <option value="spacefill">Space Fill</option>
                    <option value="cartoon">Cartoon</option>
                </select>
            </div>

            <div class="toolbar-group">
                <span class="toolbar-label">Color:</span>
                <select id="colorScheme">
                    <option value="element">By Element</option>
                    <option value="chain">By Chain</option>
                    <option value="residue">By Residue</option>
                    <option value="secondary">By Secondary Structure</option>
                    <option value="rainbow">Rainbow</option>
                    <option value="hydrophobicity">By Hydrophobicity</option>
                </select>
            </div>

            <div class="spacer"></div>

            <button id="resetCamera">Reset View</button>
        </div>

        <div class="canvas-area" id="canvasArea"></div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <div class="status-indicator"></div>
                <strong>Protein:</strong>
                <span id="proteinName">None</span>
            </div>
            <div class="status-item">
                <strong>Atoms:</strong>
                <span id="atomCount">0</span>
            </div>
            <div class="status-item">
                <strong>Bonds:</strong>
                <span id="bondCount">0</span>
            </div>
            <div class="status-item">
                <strong>Chains:</strong>
                <span id="chainCount">0</span>
            </div>
            <div class="status-item">
                <strong>Residues:</strong>
                <span id="residueCount">0</span>
            </div>
            <div class="spacer"></div>
            <div class="status-item">
                <strong>FPS:</strong>
                <span id="fps">0</span>
            </div>
            <div class="status-item">
                <strong>Quality:</strong>
                <span id="qualityIndicator">Medium</span>
            </div>
        </div>

        <!-- Sidebar Panel (Hidden by default) -->
        <div class="sidebar-panel" id="sidebarPanel">
            <div class="panel-section">
                <div class="panel-title">Load Protein</div>
                <div class="panel-control">
                    <label>Search RCSB:</label>
                    <div class="search-container">
                        <input type="text" id="pdbSearch" placeholder="Enter PDB ID (e.g., 1CRN)">
                        <button id="fetchBtn">Fetch</button>
                    </div>
                </div>
                <div class="panel-control">
                    <label>Upload File:</label>
                    <input type="file" id="pdbFile" accept=".pdb">
                </div>
                <div class="loading" id="loadingIndicator">Loading protein...</div>
                <div class="warning" id="performanceWarning">
                    Large protein detected. Consider using Wireframe mode for better performance.
                </div>
            </div>

            <div class="panel-section">
                <div class="panel-title">Quality Settings</div>
                <div class="panel-control">
                    <label>Rendering Quality:</label>
                    <select id="qualityPreset">
                        <option value="low">Low (Fastest)</option>
                        <option value="medium" selected>Medium (Balanced)</option>
                        <option value="high">High (Best Quality)</option>
                    </select>
                </div>
                <div class="panel-control">
                    <label>Sphere Detail:</label>
                    <select id="sphereDetail">
                        <option value="4">4×4 (Very Low)</option>
                        <option value="8">8×8 (Low)</option>
                        <option value="16" selected>16×16 (Medium)</option>
                        <option value="32">32×32 (High)</option>
                    </select>
                </div>
                <div class="panel-control">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="autoQuality" checked>
                        Auto-adjust quality for large proteins
                    </label>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div class="help-modal" id="helpModal">
            <div class="help-content">
                <div class="help-header">
                    <h2>Helix - Quick Start Guide</h2>
                    <button class="close-btn" id="closeHelpBtn">×</button>
                </div>
                <div class="help-body">
                    <section>
                        <h3>Loading Proteins</h3>
                        <ul>
                            <li><strong>From RCSB:</strong> Click "Load Protein" or the hamburger menu, enter a PDB ID (e.g., 1CRN, 1UBQ, 1HHO), and click Fetch</li>
                            <li><strong>Upload File:</strong> Use the file input in the sidebar to upload your own .pdb file</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Visualization Styles</h3>
                        <ul>
                            <li><strong>Ball & Stick:</strong> Shows atoms as spheres with bonds as cylinders</li>
                            <li><strong>Wireframe:</strong> Shows only bonds (best for large proteins)</li>
                            <li><strong>Space Fill:</strong> Shows atoms at Van der Waals radii (can be slow for large proteins)</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Color Schemes</h3>
                        <ul>
                            <li><strong>By Element:</strong> Standard CPK coloring (Carbon=gray, Oxygen=red, Nitrogen=blue, etc.)</li>
                            <li><strong>By Chain:</strong> Each protein chain gets a distinct color</li>
                            <li><strong>By Residue:</strong> Colors based on amino acid properties (hydrophobic, polar, acidic, basic)</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Controls</h3>
                        <ul>
                            <li><strong>Rotate:</strong> Left click and drag</li>
                            <li><strong>Pan:</strong> Right click and drag</li>
                            <li><strong>Zoom:</strong> Scroll wheel or pinch</li>
                            <li><strong>Reset View:</strong> Click "Reset View" button in toolbar</li>
                        </ul>
                    </section>

                    <section>
                        <h3>Performance Tips</h3>
                        <ul>
                            <li>For proteins &gt; 5000 atoms, use Wireframe mode for better performance</li>
                            <li>Enable "Auto-adjust quality" to automatically optimize for large proteins</li>
                            <li>Lower sphere detail in Quality Settings if experiencing lag</li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
</body>
</html>
