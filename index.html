<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helix - Protein Visualization</title>
    <link rel="stylesheet" href="src/helix.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script type="module" src="src/main.ts"></script>
</head>
<body>
    <div class="app-container">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="app-title">HELIX</div>
            <div class="protein-name" id="proteinName">No structure loaded</div>
            <div style="flex: 1;"></div>
            <div style="display: flex; gap: 8px;">
                <button class="icon-btn" id="resetCameraBtn" title="Reset Camera">âŸ²</button>
                <button class="icon-btn" id="exportBtn" title="Export Image">ðŸ“·</button>
                <button class="icon-btn" title="Settings">âš™</button>
                <button class="icon-btn" title="Help">?</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Tab (outside sidebar) -->
            <div class="sidebar-tab left" id="left-tab">Controls</div>

            <!-- Left Sidebar -->
            <div class="sidebar left" id="left-sidebar">
                <!-- Load Structure Panel -->
                <div class="panel">
                    <div class="panel-header">
                        <span>Load Structure</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="panel-content">
                        <div class="control-group">
                            <label class="control-label">Source</label>
                            <select id="sourceSelect">
                                <option value="pdb" selected>PDB (Protein Data Bank)</option>
                                <option value="pubchem">PubChem (Small Molecules)</option>
                                <option value="chembl">ChEMBL (Drug Database)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label" id="fetchInputLabel">PDB ID</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="text" id="fetchInput" placeholder="e.g. 1CRN" value="">
                                <button class="btn btn-primary" id="fetchBtn" style="width: auto; padding: 0 16px;">Fetch</button>
                            </div>
                            <div class="upload-hint" id="fetchHint" style="margin-top: 4px;">4-letter PDB code</div>
                        </div>
                        <div class="divider"></div>
                        <div class="upload-area" id="uploadArea">
                            <input type="file" id="pdbFileInput" accept=".pdb, .cif, .mmcif, .sdf, .mol, .mol2, .pdbqt, .xyz" multiple style="display: none;">
                            <div class="upload-icon">â¬†</div>
                            <div class="upload-text">Drop structure file here</div>
                            <div class="upload-hint">PDB, CIF, SDF, MOL2, PDBQT</div>
                        </div>
                    </div>
                </div>

                <!-- Loaded Proteins Panel -->
                <div class="panel">
                    <div class="panel-header">
                        <span>Loaded Proteins</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="panel-content">
                        <div id="proteinListContainer" class="protein-list">
                            <div class="info-box">
                                <div class="info-box-title">No Proteins Loaded</div>
                                Load a protein to get started
                            </div>
                        </div>
                        <button id="simulateDockingBtn" class="btn btn-primary" style="width: 100%; margin-top: 12px;" disabled>
                            Simulate Docking
                        </button>
                    </div>
                </div>

                <!-- Representation Panel -->
                <div class="panel">
                    <div class="panel-header">
                        <span>Representation</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="panel-content">
                        <div class="control-group">
                            <label class="control-label">Render Mode</label>
                            <select id="renderSelect">
                                <option value="spheres" selected>Ball and Stick</option>
                                <option value="wireframe">Wireframe</option>
                                <option value="spacefill">Space Fill</option>
                                <option value="cartoon">Cartoon</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Quality</label>
                            <select id="qualityPresetSelect">
                                <option value="ultra-low">Ultra Low (Fastest)</option>
                                <option value="low">Low (Fast)</option>
                                <option value="medium" selected>Medium (Balanced)</option>
                                <option value="high">High (Quality)</option>
                            </select>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="autoQualityCheckbox" checked>
                            <label for="autoQualityCheckbox">Auto-adjust quality for performance</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="frustumCullingCheckbox" checked>
                            <label for="frustumCullingCheckbox">Enable frustum culling (large proteins)</label>
                        </div>
                        <div class="divider"></div>
                        <div class="control-group">
                            <label class="control-label">Display Options</label>
                            <div class="checkbox-group">
                                <input type="checkbox" id="showDisulfideBondsCheckbox" checked>
                                <label for="showDisulfideBondsCheckbox">Show disulfide bonds</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="showWaterCheckbox">
                                <label for="showWaterCheckbox">Show water molecules</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Selection Panel (Future) -->
                <div class="panel collapsed">
                    <div class="panel-header">
                        <span>Selection</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="panel-content">
                        <div class="info-box">
                            <div class="info-box-title">No Selection</div>
                            Click atoms, residues, or chains to select
                        </div>
                    </div>
                </div>

                <!-- Measurements Panel (Future) -->
                <div class="panel collapsed">
                    <div class="panel-header">
                        <span>Measurements</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="panel-content">
                        <div class="info-box">
                            <div class="info-box-title">Getting Started</div>
                            Select two atoms to measure distance
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Viewport -->
            <div class="viewport" id="viewport">
                <div class="viewport-overlay">
                    <div class="viewport-stats">
                        <span class="stat-label">Atoms</span>
                        <span class="stat-value" id="atomCount">642</span>
                        <span class="stat-label">Bonds</span>
                        <span class="stat-value" id="bondCount">635</span>
                        <span class="stat-label">Chains</span>
                        <span class="stat-value" id="chainCount">1</span>
                        <span class="stat-label">Residues</span>
                        <span class="stat-value" id="residueCount">46</span>
                        <span class="stat-label">FPS</span>
                        <span class="stat-value" id="fps">60</span>
                    </div>
                </div>

            </div>

            <!-- Right Tab (outside sidebar) -->
            <div class="sidebar-tab right" id="right-tab">Colors</div>

            <!-- Right Sidebar -->
            <div class="sidebar right" id="right-sidebar">
                <!-- Color Scheme Selector -->
                <div class="panel">
                    <div class="panel-header no-collapse">
                        <span>Color Scheme</span>
                    </div>
                    <div style="padding: 0;">
                        <!-- Basic Schemes Category -->
                        <div class="scheme-category">
                            <div class="category-header">
                                <span>Basic Schemes</span>
                                <span class="chevron">â–¼</span>
                            </div>
                            <div class="category-content">
                                <div class="scheme-option active" data-scheme="element" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">By Element</div>
                                        <div class="scheme-desc">CPK atom colors</div>
                                    </div>
                                </div>
                                <div class="scheme-option" data-scheme="chain" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">By Chain</div>
                                        <div class="scheme-desc">Unique color per chain</div>
                                    </div>
                                </div>
                                <div class="scheme-option" data-scheme="residue" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">By Residue</div>
                                        <div class="scheme-desc">Amino acid type</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Property-Based Category -->
                        <div class="scheme-category">
                            <div class="category-header">
                                <span>Property-Based</span>
                                <span class="chevron">â–¼</span>
                            </div>
                            <div class="category-content">
                                <div class="scheme-option" data-scheme="hydrophobicity" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">Hydrophobicity</div>
                                        <div class="scheme-desc">Kyte-Doolittle scale</div>
                                    </div>
                                </div>
                                <div class="scheme-option" data-scheme="electrostatic" data-realtime="false">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">Electrostatic</div>
                                        <div class="scheme-desc">Surface charge potential</div>
                                    </div>
                                    <span class="scheme-badge compute">Compute</span>
                                </div>
                                <div class="scheme-option" data-scheme="bfactor" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">B-Factor</div>
                                        <div class="scheme-desc">Thermal motion</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Structural Category -->
                        <div class="scheme-category">
                            <div class="category-header">
                                <span>Structural</span>
                                <span class="chevron">â–¼</span>
                            </div>
                            <div class="category-content">
                                <div class="scheme-option" data-scheme="secondary" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">Secondary Structure</div>
                                        <div class="scheme-desc">Helices, sheets, loops</div>
                                    </div>
                                </div>
                                <div class="scheme-option" data-scheme="rainbow" data-realtime="true">
                                    <div class="scheme-indicator"></div>
                                    <div class="scheme-info">
                                        <div class="scheme-name">Rainbow</div>
                                        <div class="scheme-desc">Nâ†’C terminus gradient</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Color Scheme Parameters -->
                <div class="panel">
                    <div class="panel-header">
                        <span>Scheme Parameters</span>
                        <span class="chevron">â–¼</span>
                    </div>
                    <div class="panel-content" id="parameter-content">
                        <!-- Parameters load dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-indicator" id="statusIndicator"></span>
                <span id="statusText">Ready</span>
            </div>
            <div class="status-item">
                <span id="qualityStatus">Quality: Medium</span>
            </div>
            <div class="status-item">
                <span id="renderModeStatus">Render: Cartoon</span>
            </div>
            <div class="status-item">
                <span id="color-scheme-status">Color: By Element</span>
            </div>
            <div style="flex: 1;"></div>
            <div class="status-item">
                <span>v0.1.0-alpha</span>
            </div>
        </div>
    </div>

    <script>
        // Sidebar toggle functionality
        const leftSidebar = document.getElementById('left-sidebar');
        const rightSidebar = document.getElementById('right-sidebar');
        const leftTab = document.getElementById('left-tab');
        const rightTab = document.getElementById('right-tab');

        // Start with left sidebar open, right sidebar hidden
        leftTab.classList.add('sidebar-open');
        rightSidebar.classList.add('collapsed');

        leftTab.addEventListener('click', () => {
            leftSidebar.classList.toggle('collapsed');
            leftTab.classList.toggle('sidebar-open');
        });

        rightTab.addEventListener('click', () => {
            rightSidebar.classList.toggle('collapsed');
            rightTab.classList.toggle('sidebar-open');
        });

        // Panel collapse functionality
        document.querySelectorAll('.panel-header').forEach(header => {
            if (!header.classList.contains('no-collapse')) {
                header.addEventListener('click', function() {
                    this.parentElement.classList.toggle('collapsed');
                });
            }
        });

        // Category collapse functionality
        document.querySelectorAll('.category-header').forEach(header => {
            header.addEventListener('click', function() {
                this.parentElement.classList.toggle('collapsed');
            });
        });
    </script>

    <!-- Docking Simulation Modal -->
    <div id="dockingModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Simulate Docking</h2>
                <button class="modal-close" id="modalCloseBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="control-group">
                    <label class="control-label">Receptor Protein</label>
                    <select id="receptorSelect" class="modal-select">
                        <option value="">Select receptor protein...</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label">Ligand Protein</label>
                    <select id="ligandSelect" class="modal-select">
                        <option value="">Select ligand protein...</option>
                    </select>
                </div>
                <div class="info-box" style="margin-top: 16px;">
                    <div class="info-box-title">About Docking</div>
                    Select two proteins to simulate molecular docking. The receptor is typically the larger protein, and the ligand is the smaller molecule that binds to it.
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelDockingBtn" class="btn">Cancel</button>
                <button id="runDockingBtn" class="btn btn-primary" disabled>Run Simulation</button>
            </div>
        </div>
    </div>

</body>
</html>
